# ðŸ§  Product Serving: ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ Servingì˜ ì¢…ë¥˜ì™€ ë‹¤ì–‘í•œ íŒ¨í„´

> ë³¸ ë¬¸ì„œëŠ” ë„¤ì´ë²„ ì»¤ë„¥íŠ¸ ìž¬ë‹¨ì˜ Product Serving ê°•ì˜ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì •ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.  
> ëª©ì : ì‹¤ì œ í™˜ê²½ì—ì„œ ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì„ íš¨ê³¼ì ìœ¼ë¡œ ë°°í¬(Serving)í•˜ê¸° ìœ„í•œ ê°œë… ë° ì„¤ê³„ íŒ¨í„´ í•™ìŠµ.

---

## ðŸ“ 1. Serving: ëª¨ë¸ì„ ì„¸ìƒìœ¼ë¡œ

### 1.1 Servingì˜ ì •ì˜

- **Serving**ì´ëž€ â€œëª¨ë¸ì˜ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ìš”ì²­í•œ í´ë¼ì´ì–¸íŠ¸(Client)ì—ê²Œ ì œê³µí•˜ëŠ” ê³¼ì •â€ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
- ì¦‰, **ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì„ ì‹¤ì œ ìš´ì˜ í™˜ê²½(Production)**ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìžˆë„ë¡ ë°°í¬í•˜ëŠ” ê²ƒì„ ë§í•©ë‹ˆë‹¤.
- ì—°êµ¬ ë‹¨ê³„(Research)ì—ì„œ ë§Œë“¤ì–´ì§„ ëª¨ë¸ì„ ì‹¤ì œ ì„œë¹„ìŠ¤ì— â€œì„œë¹„ìŠ¤í™”(Serving)â€í•˜ëŠ” ê³¼ì •ìž…ë‹ˆë‹¤.

> ðŸ’¡ ë¹„ìœ :  
> Research ë‹¨ê³„ì—ì„œ ë§Œë“  ìš”ë¦¬ë¥¼ ì‹¤ì œ ì‹íƒ(Production)ì— â€œì„œë¹™â€í•˜ëŠ” ê³¼ì •.  
> ì£¼ë¬¸(Request)ì´ ë“¤ì–´ì˜¤ë©´, ëª¨ë¸ì´ ì˜ˆì¸¡(Output)ì„ ë°˜í™˜í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸(Client)ì—ê²Œ ì œê³µ.

---

### 1.2 Servingì˜ ëŒ€í‘œ ì˜ˆì‹œ

| ì˜ˆì‹œ | ì„¤ëª… |
|------|------|
| ðŸŽ¬ **YouTube ì¶”ì²œ ì‹œìŠ¤í…œ** | ê°œì¸í™”ëœ ì˜ìƒ ì¶”ì²œ (Online Serving) |
| ðŸŒ **DeepL ë²ˆì—­ê¸°** | ìž…ë ¥ ì–¸ì–´ â†’ ì¶œë ¥ ì–¸ì–´ ì‹¤ì‹œê°„ ë²ˆì—­ |
| ðŸš— **ì˜ì¹´ ì°¨ëŸ‰ ìƒíƒœ ë¶„ë¥˜** | ì°¨ëŸ‰ ì™¸ê´€ ì´ë¯¸ì§€ë¥¼ ë¶„ì„í•´ ì„¸ì°¨ í•„ìš”ì„± ë¶„ë¥˜ |

---

### 1.3 Servingì˜ ì¢…ë¥˜

#### (1) **Batch Serving**
- **ì¼ê´„ ì²˜ë¦¬ ë°©ì‹**ìœ¼ë¡œ ì¼ì • ì£¼ê¸°(ì‹œê°„ ë‹¨ìœ„ ë“±)ì— ë°ì´í„°ë¥¼ ëª¨ì•„ ì˜ˆì¸¡ì„ ìˆ˜í–‰.  
- ì˜ˆ: ë§¤ì¼ 20ì‹œì— ì „ì²´ ë°ì´í„°ë¥¼ ì˜ˆì¸¡ í›„ DBì— ì €ìž¥ â†’ ì„œë¹„ìŠ¤ëŠ” í•´ë‹¹ ê²°ê³¼ë¥¼ í™œìš©.
- ì‹¤ì‹œê°„ ì‘ë‹µì´ ì¤‘ìš”í•˜ì§€ ì•Šì€ ê²½ìš°ì— ì í•©.

#### (2) **Online (Real-Time) Serving**
- **ìš”ì²­ ì‹œ ì¦‰ì‹œ ì˜ˆì¸¡**í•˜ëŠ” ë°©ì‹.
- ì˜ˆ: API Request ì‹œ ë°ì´í„°ë¥¼ í•¨ê»˜ ë³´ë‚´ê³  ì¦‰ê°ì ì¸ ì‘ë‹µì„ ë°›ìŒ.
- ì‹¤ì‹œê°„ ì‘ë‹µ, ë™ì  ë°ì´í„°, ê°œì¸í™” ì„œë¹„ìŠ¤ì— ì í•©.

---

### 1.4 ì–´ë–¤ Servingì„ ì‚¬ìš©í• ê¹Œ?

| êµ¬ë¶„ | Batch Serving | Online Serving |
|------|----------------|----------------|
| âš™ï¸ ìƒí™© | ì‹¤ì‹œê°„ ì‘ë‹µì´ ì¤‘ìš”í•˜ì§€ ì•ŠìŒ / ëŒ€ëŸ‰ ë°ì´í„° / ì •ê¸°ì  ìž‘ì—… | ì‹¤ì‹œê°„ ì‘ë‹µ ì¤‘ìš” / ë§žì¶¤í˜• ì‘ë‹µ / ë°ì´í„°ê°€ ì§€ì†ì ìœ¼ë¡œ ë³€í•¨ |
| ðŸ‘¥ ì¸ë ¥ | ì¸ë ¥ì´ ì ì„ ë•Œ ìœ ë¦¬ | API ì„œë²„, ì‹¤ì‹œê°„ ì²˜ë¦¬ ê²½í—˜ í•„ìš” |
| ðŸ’¾ ë°ì´í„° ì €ìž¥ | RDB, DW ì¤‘ì‹¬ | ìš”ì²­ ì‹œ ë°ì´í„° í¬í•¨ ì „ë‹¬ |
| ðŸ§© ì˜ˆì‹œ | Netflix ì¶”ì²œ, DoorDash | ìœ íŠœë¸Œ ì¶”ì²œ, ì€í–‰ ì‚¬ê¸° íƒì§€ |

---

## ðŸ§± 2. ë‹¨ìˆœí•œ Serving íŒ¨í„´ (Machine Learning Design Patterns)

> ë¨¸ì‹ ëŸ¬ë‹ ì‹œìŠ¤í…œì€ **Data + Model + Code**ì˜ ë³µí•© êµ¬ì¡°ì´ë¯€ë¡œ,  
> ì¼ë°˜ ì†Œí”„íŠ¸ì›¨ì–´ì™€ ë‹¬ë¦¬ ML íŠ¹í™”ëœ ë””ìžì¸ íŒ¨í„´ì´ í•„ìš”í•©ë‹ˆë‹¤.

### 2.1 ë””ìžì¸ íŒ¨í„´ì˜ ê°œë…

- ë°˜ë³µë˜ëŠ” ë¬¸ì œ í•´ê²° ë°©ì‹ì„ êµ¬ì¡°í™”í•œ **í…œí”Œë¦¿(Template)**.
- ëª©ì : ìž¬ì‚¬ìš©ì„±, ê°€ë…ì„±, í™•ìž¥ì„± í–¥ìƒ.
- â€œì´ë²ˆ Servingì€ Batch íŒ¨í„´ìœ¼ë¡œ ê°€ìž!â€ ì²˜ëŸ¼ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ë„êµ¬ë¡œë„ ì‚¬ìš©ë¨.
- ë°˜ëŒ€ë¡œ **Anti-Pattern**ì€ ì§€ì–‘í•´ì•¼ í•  ë¹„íš¨ìœ¨ì  êµ¬ì¡°ë¥¼ ì˜ë¯¸.

---

### 2.2 ë¨¸ì‹ ëŸ¬ë‹ ë””ìžì¸ íŒ¨í„´ì˜ í•„ìš”ì„±

- ì¼ë°˜ ê°œë°œê³¼ ë‹¬ë¦¬ ë°ì´í„°ì™€ ëª¨ë¸ ê´€ë¦¬, ëŒ€ìš©ëŸ‰ ì²˜ë¦¬, ì˜ˆì¸¡ ì§€ì—° ë“±ì˜ ì´ìŠˆ ì¡´ìž¬.
- í•™ìŠµâ€“ì˜ˆì¸¡â€“ìš´ì˜ ê³¼ì •ì—ì„œ ìƒê¸´ ë…¸í•˜ìš°ê°€ â€˜íŒ¨í„´í™”â€™ë¨.
- ì™„ë²½í•œ ì •ë‹µì€ ì—†ìœ¼ë©°, **â€œìƒí™©ì— ë§žëŠ” ì„¤ê³„ ê°ê°â€**ì„ ìµížˆëŠ” ê²ƒì´ ì¤‘ìš”.

---

## âš™ï¸ Servingì˜ 4ê°€ì§€ ê¸°ë³¸ íŒ¨í„´

| êµ¬ë¶„ | Serving ìœ í˜• | íŠ¹ì§• ìš”ì•½ |
|------|---------------|------------|
| 1ï¸âƒ£ **Batch íŒ¨í„´** | Batch Serving | ì£¼ê¸°ì  Job ìˆ˜í–‰, ì˜ˆì¸¡ ê²°ê³¼ë¥¼ DBì— ì €ìž¥ |
| 2ï¸âƒ£ **Web Single íŒ¨í„´** | Online Serving | ë‹¨ì¼ API ì„œë²„ë¡œ ëª¨ë¸ì„ ë¡œë“œí•˜ì—¬ ì¦‰ì‹œ ì˜ˆì¸¡ |
| 3ï¸âƒ£ **Synchronous íŒ¨í„´** | Online Serving | ìš”ì²­-ì‘ë‹µì´ ìˆœì°¨ì ìœ¼ë¡œ ì§„í–‰ë˜ëŠ” ë™ê¸°ì‹ êµ¬ì¡° |
| 4ï¸âƒ£ **Asynchronous íŒ¨í„´** | Online Serving | ë©”ì‹œì§€ í ê¸°ë°˜ ë¹„ë™ê¸° êµ¬ì¡° (ì˜ˆ: Kafka) |

---

### ðŸ”¹ (1) Batch íŒ¨í„´

#### ê°œë…
- ì¼ì • ì£¼ê¸°ë¡œ ëª¨ë¸ ì˜ˆì¸¡ì„ ìˆ˜í–‰í•˜ê³ , ê²°ê³¼ë¥¼ DBì— ì €ìž¥í•´ í™œìš©.
- ì‹¤ì‹œê°„ì„±ì´ í•„ìš” ì—†ëŠ” ê²½ìš°ì— ì í•©.

#### êµ¬ì„± ìš”ì†Œ
- **Job Management Server**: Apache Airflow ë“± ìŠ¤ì¼€ì¤„ë§ ë‹´ë‹¹.
- **Job**: ëª¨ë¸ ë¡œë“œ + ë°ì´í„° ë¡œë“œ + ì˜ˆì¸¡ ìˆ˜í–‰ ë‹¨ìœ„.
- **Data Storage**: ê²°ê³¼ë¥¼ ì €ìž¥í•˜ëŠ” DB ë˜ëŠ” DW.

#### ìž¥ì 
- API ì„œë²„ ë¶ˆí•„ìš”, ë‹¨ìˆœ êµ¬ì¡°.
- ê¸°ì¡´ ì½”ë“œ ìž¬ì‚¬ìš© ê°€ëŠ¥.
- ì„œë²„ ìžì› ê´€ë¦¬ ìœ ì—°.

#### ë‹¨ì 
- ë³„ë„ ìŠ¤ì¼€ì¤„ëŸ¬ í•„ìš”.
- ì˜ˆì¸¡ ê²°ê³¼ ë°˜ì˜ì´ ì¦‰ì‹œ ì´ë£¨ì–´ì§€ì§€ ì•ŠìŒ.

#### ì˜ˆì‹œ
- Netflix ì¶”ì²œ ëª¨ë¸ (1ì‹œê°„~24ì‹œê°„ ë‹¨ìœ„ ì˜ˆì¸¡ ì €ìž¥)

---

### ðŸ”¹ (2) Web Single íŒ¨í„´

#### ê°œë…
- ëª¨ë¸ì„ í¬í•¨í•œ ë‹¨ì¼ API ì„œë²„(FastAPI, Flask ë“±)ë¥¼ ë°°í¬í•˜ì—¬ ìš”ì²­ ì‹œ ì¦‰ì‹œ ì˜ˆì¸¡.
- **FastAPI â†’ `/predict`** ì™€ ê°™ì€ ì—”ë“œí¬ì¸íŠ¸ë¥¼ êµ¬ì„±.

#### êµ¬ì„± ìš”ì†Œ
- **Client**: ì•±, ì›¹, í˜¹ì€ ë°±ì—”ë“œ ì„œë²„.
- **Model Server**: FastAPI, Flaskë¡œ êµ¬ì„±ëœ ë‹¨ì¼ ì„œë²„.
- **Load Balancer**: Nginx, AWS ELB ë“±ìœ¼ë¡œ íŠ¸ëž˜í”½ ë¶„ì‚°.

#### ìž¥ì 
- êµ¬ì¡° ë‹¨ìˆœ, ê°œë°œ ì§„ìž… ìž¥ë²½ ë‚®ìŒ.
- ë¹ ë¥¸ í”„ë¡œí† íƒ€ì´í•‘ì— ì í•©.

#### ë‹¨ì 
- ëª¨ë¸ ë³€ê²½ ì‹œ ì „ì²´ ìž¬ë°°í¬ í•„ìš”.
- ëŒ€í˜• ëª¨ë¸ì¼ ê²½ìš° ë¡œë“œ ì§€ì—° ë°œìƒ.

---

### ðŸ”¹ (3) Synchronous íŒ¨í„´

#### ê°œë…
- ìš”ì²­ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ëŠ” **ë™ê¸°ì‹(Blocking)** êµ¬ì¡°.
- ëŒ€ë¶€ë¶„ì˜ REST APIëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì´ ë°©ì‹.

#### ìž¥ì 
- ì•„í‚¤í…ì²˜ ë‹¨ìˆœ, ì›Œí¬í”Œë¡œìš° ëª…í™•.
- ìš”ì²­-ì‘ë‹µ ê¸°ë°˜ ì„œë¹„ìŠ¤ì— ì í•©.

#### ë‹¨ì 
- ìš”ì²­ì´ ëª°ë¦´ ê²½ìš° ë³‘ëª© ë°œìƒ.
- ì˜ˆì¸¡ ì§€ì—° ì‹œ ì‚¬ìš©ìž ê²½í—˜ ì €í•˜.

#### ì˜ˆì‹œ
- ì˜ˆì¸¡ ê²°ê³¼ì— ë”°ë¼ UIê°€ ì¦‰ì‹œ ë‹¬ë¼ì§€ëŠ” ê²½ìš°  
  (ì˜ˆ: â€œê°•ì•„ì§€ vs ê³ ì–‘ì´â€ ì´ë¯¸ì§€ ë¶„ë¥˜ ê²°ê³¼ì— ë”°ë¼ íŽ˜ì´ì§€ ë³€ê²½)

---

### ðŸ”¹ (4) Asynchronous íŒ¨í„´

#### ê°œë…
- í´ë¼ì´ì–¸íŠ¸ì™€ ì˜ˆì¸¡ ì„œë²„ ì‚¬ì´ì— **ë©”ì‹œì§€ í(Queue)**ë¥¼ ë‘¬ ìš”ì²­ì„ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬.
- ëŒ€í‘œ ë„êµ¬: **Apache Kafka, RabbitMQ ë“±**.

#### ìž¥ì 
- í´ë¼ì´ì–¸íŠ¸ì™€ ì˜ˆì¸¡ í”„ë¡œì„¸ìŠ¤ ë¶„ë¦¬ â†’ ë…ë¦½ì  í™•ìž¥ ê°€ëŠ¥.
- ìš”ì²­ê³¼ ì‘ë‹µì„ ë³‘ë ¬ì ìœ¼ë¡œ ì²˜ë¦¬ ê°€ëŠ¥.

#### ë‹¨ì 
- ë©”ì‹œì§€ í ì‹œìŠ¤í…œ êµ¬ì¶• í•„ìš”.
- ì‹¤ì‹œê°„ì„±ì´ ì•½ê°„ ë–¨ì–´ì§ˆ ìˆ˜ ìžˆìŒ.

#### ì˜ˆì‹œ
- ëŒ€ê·œëª¨ ìš”ì²­ ì²˜ë¦¬, ëŒ€ê¸°ì—´ ê¸°ë°˜ ì„œë¹„ìŠ¤ êµ¬ì¡° (ì˜ˆ: ëŒ€ëŸ‰ ì´ë¯¸ì§€ ë¶„ì„ ìš”ì²­ ë“±)

---

## ðŸš« 3. Anti-Serving íŒ¨í„´

> ê¶Œìž¥ë˜ì§€ ì•ŠëŠ” êµ¬ì¡°ì´ì§€ë§Œ, ì‹¤ì œ í™˜ê²½ì—ì„œ ìžì£¼ ë°œìƒí•¨.  
> â€œì´ëŸ° ë°©ì‹ì€ í”¼í•´ì•¼ í•œë‹¤â€ë¥¼ í•™ìŠµí•˜ëŠ” ê²ƒì´ í•µì‹¬.

### âŒ (1) Online Bigsize íŒ¨í„´

- **ì‹¤ì‹œê°„ ì„œë¹„ìŠ¤ì—ì„œ ë„ˆë¬´ í° ëª¨ë¸**ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°.
- ì˜ˆì¸¡ ì‘ë‹µì´ ìˆ˜ ì´ˆ ì´ìƒ ê±¸ë¦¬ê±°ë‚˜ ì„œë²„ ë¶€íŒ…ì´ ëŠë¦° ê²½ìš° ë¬¸ì œ ë°œìƒ.

#### ë¬¸ì œì 
- ì‘ë‹µ ì§€ì—°, ì„œë²„ ë¶€í•˜, ë¹„ìš© ì¦ê°€.
- ì†ë„ì™€ ë¹„ìš© ê°„ Trade-off.

#### ëŒ€ì•ˆ
- ëª¨ë¸ ê²½ëŸ‰í™” / ìºì‹± ì„œë²„ ë„ìž… / ì „ì²˜ë¦¬ ë¶„ë¦¬ / Batch ì „í™˜ ê³ ë ¤.

---

### âŒ (2) All-in-one íŒ¨í„´

- ì—¬ëŸ¬ ì˜ˆì¸¡ ëª¨ë¸ì„ **í•˜ë‚˜ì˜ ì„œë²„**ì— ë™ì‹œì— ì˜¬ë ¤ ìš´ì˜í•˜ëŠ” ë°©ì‹.

#### ë¬¸ì œì 
- ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶©ëŒ ìœ„í—˜.
- ë‹¨ì¼ ìž¥ì• ì (SPOF, Single Point of Failure) ë°œìƒ.
- ì„œë²„ ë‹¤ìš´ ì‹œ ì „ì²´ ì„œë¹„ìŠ¤ ì¤‘ë‹¨.

#### ëŒ€ì•ˆ
- **ëª¨ë¸ë³„ ë…ë¦½ ì„œë²„ êµ¬ì„± (Microservice Architecture)**  
- í•„ìš”ì— ë”°ë¼ ëª¨ë¸ë³„ë¡œ ìŠ¤ì¼€ì¼ë§.

---

## ðŸ“š ì „ì²´ ìš”ì•½

| êµ¬ë¶„ | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|
| **Batch Serving** | ì£¼ê¸°ì  ì˜ˆì¸¡ í›„ DB ì €ìž¥ | Netflix ì¶”ì²œ |
| **Online Serving** | ìš”ì²­ ì‹œ ì¦‰ì‹œ ì˜ˆì¸¡ | YouTube, DeepL |
| **Web Single íŒ¨í„´** | ë‹¨ì¼ REST API ì„œë²„ | FastAPI, Flask |
| **Synchronous íŒ¨í„´** | ìš”ì²­ ì™„ë£Œê¹Œì§€ ëŒ€ê¸° | ì‹¤ì‹œê°„ UI ë°˜ì‘ |
| **Asynchronous íŒ¨í„´** | ë©”ì‹œì§€ í ê¸°ë°˜ ë¹„ë™ê¸° ì²˜ë¦¬ | Kafka, RabbitMQ |
| **Online Bigsize (Anti)** | ì‹¤ì‹œê°„ì— ëŒ€í˜• ëª¨ë¸ ì‚¬ìš© | ì‘ë‹µ ì§€ì—° ë¬¸ì œ |
| **All-in-one (Anti)** | ë‹¤ì¤‘ ëª¨ë¸ì„ ë‹¨ì¼ ì„œë²„ì— ìš´ì˜ | SPOF ë°œìƒ ìœ„í—˜ |

---

## ðŸ§© Key Takeaways

- **Servingì˜ í•µì‹¬ì€ â€œë¬¸ì œ ìƒí™©ì— ë§žëŠ” ì•„í‚¤í…ì²˜ ì„ íƒâ€**  
- **Batch â†” Online**, **Sync â†” Async**ëŠ” íŠ¸ë ˆì´ë“œì˜¤í”„ ê´€ê³„  
- **Anti íŒ¨í„´ì„ ì¸ì§€í•˜ê³  íšŒí”¼í•˜ëŠ” ëŠ¥ë ¥**ì´ ê³§ ML ì—”ì§€ë‹ˆì–´ë§ ì‹¤ë ¥  
- í–¥í›„ ê³¼ì œ ì„ ì • ì‹œ,  
  - ë°ì´í„° ì£¼ê¸°ì„±  
  - ëª¨ë¸ í¬ê¸°  
  - ì‘ë‹µ ì§€ì—° í—ˆìš© ë²”ìœ„  
  - ê°œë°œ ì¸ë ¥ ê·œëª¨  
  ë“±ì„ ê¸°ì¤€ìœ¼ë¡œ Serving êµ¬ì¡°ë¥¼ ì„¤ê³„í•´ì•¼ í•¨.

---

> ðŸ“– Reference:  
> - NAVER Connect Foundation, *Product Serving: Servingì˜ ì •ì˜ì™€ ë‹¤ì–‘í•œ íŒ¨í„´*  
> - Mercari ML System Design Patterns (https://mercari.github.io/ml-system-design-pattern/)
> - Github https://github.com/zzsza/Boostcamp-AI-Tech-Product-Serving